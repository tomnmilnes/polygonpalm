(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();let v=[{name:"BOMB",image:["../img/distractions/bomb.gif","../img/distractions/bomb-clicked.png"],soundClips:["sound/bomb.wav"],timeAdjustment:-3,timesClicked:0,timeImage:"../img/time/minus3t.png"},{name:"TROLL",image:["../img/distractions/trollface.gif","../img/distractions/trollface-clicked.png"],soundClips:["sound/trolls.mp3"],timeAdjustment:-3,timesClicked:0,timeImage:"../img/time/minus3t.png"},{name:"VIRUS",image:["../img/distractions/virus.gif","../img/distractions/virus-clicked.png"],soundClips:["sound/virus.mp3"],timeAdjustment:-3,timesClicked:0,timeImage:"../img/time/minus3t.png"},{name:"NEWS",image:["../img/distractions/news.gif","../img/distractions/news-clicked.png"],soundClips:["sound/news.mp3"],timeAdjustment:-5,timesClicked:0,timeImage:"../img/time/minus5t.png"},{name:"DISCOUNT",image:["../img/distractions/discount.gif","../img/distractions/discount-clicked.png"],soundClips:["sound/discount.mp3"],timeAdjustment:-5,timesClicked:0,timeImage:"../img/time/minus5t.png"},{name:"BOOBS",image:["../img/distractions/boobs.gif","../img/distractions/boobs-clicked.png"],soundClips:["sound/boobs.mp3"],timeAdjustment:3,timesClicked:0,timeImage:"../img/time/plus3t.png"},{name:"DICK",image:["../img/distractions/dick.gif","../img/distractions/dick-clicked.png"],soundClips:["sound/dick.mp3"],timeAdjustment:3,timesClicked:0,timeImage:"../img/time/plus3t.png"},{name:"CAT",image:["../img/distractions/cat.gif","../img/distractions/cat-clicked.png"],soundClips:["sound/cats.mp3"],timeAdjustment:3,timesClicked:0,timeImage:"../img/time/plus3t.png"},{name:"MINDFULNESS",image:["../img/distractions/mindfulness.gif","../img/distractions/mindfulness-clicked.png"],soundClips:["sound/mindfullness.mp3"],timeAdjustment:5,timesClicked:0,timeImage:"../img/time/plus5t.png"},{name:"DRUGS",image:["../img/distractions/drugs.gif","../img/distractions/drugs-clicked.png"],soundClips:["sound/drugs.mp3"],timeAdjustment:5,timesClicked:0,timeImage:"../img/time/plus5t.png"},{name:"AI",image:["../img/distractions/AI.gif","../img/distractions/AI-clicked.png"],soundClips:["sound/AI.mp3"],timeAdjustment:3,timesClicked:0,timeImage:"../img/time/plus3t.png"},{name:"CRYPTO",image:["../img/distractions/crypto.gif","../img/distractions/crypto-clicked.png"],soundClips:["sound/crypto.mp3"],timeAdjustment:-3,timesClicked:0,timeImage:"../img/time/minus3t.png"}];function Be(){const e={};return v.forEach(r=>{e[r.name]=r.timesClicked}),e}const we={0:[],1:["CAT"],2:["CAT","TROLL","DRUGS"],3:[],4:["TROLL","DRUGS"],5:["CRYPTO","AI","DRUGS"],6:["MINDFULNESS"],7:[],8:["BOOBS","DICK"],9:[],10:["DISCOUNT","VIRUS","BOOBS"],11:["BOMB","NEWS","TROLL"],12:["BOMB","BOOBS","DISCOUNT","NEWS","MINDFULNESS","DRUGS","TROLL","CAT","VIRUS","BOMB","CRYPTO","AI"],13:["VIRUS"],14:[]},Oe={0:"sound/tomb-ambience.wav",1:"sound/tomb-ambience.wav",2:"sound/tomb-ambience.wav",3:"sound/tomb-ambience.wav",4:"sound/tomb-ambience.wav",5:"sound/tomb-ambience.wav",6:"sound/full.mp3",7:"sound/tomb-ambience.wav",8:"sound/tomb-ambience.wav",9:"sound/tomb-ambience.wav",10:"sound/tomb-ambience.wav",11:"sound/tomb-ambience.wav",12:"sound/tomb-ambience.wav",13:"sound/tomb-ambience.wav",14:"sound/tomb-ambience.wav"},Re={0:[0],1:[12],2:[8,4,8],3:[0],4:[0,0],5:[6,6,6],6:[20],7:[0],8:[2,3],9:[0],10:[6,6,4],11:[8,8,8],12:[1,2,3,4,5,6,7,8,9,10],13:[40],14:[0]},Pe={0:0,1:60,2:60,3:60,4:60,5:120,6:30,7:60,8:60,9:60,10:120,11:60,12:120,13:60,14:60},De={0:"",1:"1.</br> CUTE ENCOUNTERS",2:"2.</br> MAD MEN ON SPEED",3:"",4:"",5:"5.</br> GET UP TO SPEED!",6:"6.</br> THE HEALING LOVE OF THE UNIVERSE",7:"",8:"8.</br> PLEASURE",9:"",10:"10.</br> INFECTED",11:"11.</br> POLITICS",12:"12.</br> AN ALL YOU CAN EAT BUFFET",13:"13.</br> ENDGAME",14:""},Ne={0:"<center>What is doomscrolling?</br></br></br>↓</br></br></br></br>What does it do?</br></br></br></br>↓</br></br></br>What is the point?</br></br></br>↓</center>",1:"Mobile phone usage oscillates between play and labor. Users are trapped in endless loops of content consumption, reacting, filtering real from fake, and managing emotional responses.</br><br></br></br>Humor and distraction offer brief relief. Cat videos, memes, and lighthearted content punctuate the despair but do not end the cycle. The pull to return to the feed remains strong.</br><br></br></br>Mobile phone usage oscillates between play and labor. Users are trapped in endless loops of content consumption, reacting, filtering real from fake, and managing emotional responses.",2:"The aesthetics of doomscrolling amplify its absurdity. Cartoonish visuals and exaggerated headlines turn the experience into a grotesque parody of contemporary culture. A carnival of content drawing users into an endless loop.</br><br></br></br>Unlike traditional media, doomscrolling refuses resolution. There is no progress and no closure only a perpetual avoidance of despair. The activity mimics the very structure of digital engagement—endless, attention-consuming, and ultimately exhausting.</br><br></br></br>The aesthetics of digital despair shape perception. Headlines are designed for urgency. Notifications demand attention. Algorithms curate content to keep users engaged, ensuring there is always more to see.",3:"Any opinions to share?<input type='text' id='essayInput' placeholder='Share it here...'><button id='submitButton'><p id='submitButtonText'>Submit</p></button>",4:"↓</br></br></br></br></br></br></br></br></br></br</br></br>↓<br></br></br></br></br><br></br></br></br></br><br></br>↓<br></br></br></br></br><br></br></br></br></br><br></br></br>At some point you look up from your screen.</br></br><br></br></br></br></br>↓<br></br></br></br></br><br></br></br>You look around.</br></br><br></br></br></br></br>↓<br></br></br></br></br><br></br></br>You look down at your hand, arm, body.</br></br><br></br></br></br></br>↓</br></br></br></br><br></br></br>There is something lonely about this whole thing.</br></br><br></br></br></br></br>↓</br></br></br></br><br></br></br><i>You thought games were supposed to be fun.</i></br></br></br></br></br></br></br>↓</br><br></br></br><br></br></br>Don't give up.</br></br></br></br><br></br></br>↓</br></br></br></br><br></br></br>Maybe the next level has something exciting for you?</br></br></br></br><br></br></br>↓</br></br></br></br><br></br></br>The future is in your hand.</br></br><br></br></br></br><br>↓</br></br></br></br></br></br></br>Those who reject artificial intelligence will be left behind.</br></br></br><br></br></br></br>↓</br></br><br></br></br></br></br>Those who don't hop on the crypto train are doomed to taxation.</br></br><br></br></br></br><br>↓</br></br></br></br></br></br></br>Those who can't handle microdosing can not keep up with the pace of the system.</br></br></br><br></br></br></br>↓</br></br><br></br></br></br></br>It's better to read single lines than comprehensive paragraphs.</br></br></br><br></br></br></br>↓<br></br></br></br></br></br></br>Paragraphs belong to the past.</br></br></br><br></br></br></br>↓</br></br><br></br></br></br></br>One-liners belong to the future.</br></br></br><br></br></br></br>↓</br><br></br></br></br></br></br>You belong to the future.</br></br></br></br></br></br><br>↓</br></br><br></br></br></br></br>Scroll there, now.</br></br><br></br></br></br></br>↓<br></br></br></br></br><br></br></br>Scroll harder, to reach the next level.</br></br></br><br></br></br></br>↓</br><br></br></br></br></br></br>Scroll harder or die trying.<br></br></br></br></br><br></br></br></br></br><br></br>↓<br></br></br></br></br><br></br></br></br></br><br></br>↓<br></br></br></br></br><br></br></br></br></br><br></br>",5:"</br></br><br></br></br></br></br><br></br></br></br></br><br></br></br></br></br><br></br></br></br></br><br></br></br></br></br><br></br></br></br></br><br></br></br></br></br><br></br></br></br></br><br></br></br></br></br><br></br></br></br></br><br></br></br></br></br><br></br></br>",6:"</br></br>Breathe in...</br></br><br></br></br></br>Breathe out...</br></br><br></br></br></br>Breathe in...</br></br><br></br></br></br>Breathe out...</br></br><br></br></br></br>Open yourself up to receive.</br></br><br></br></br></br>Everything you want.</br></br><br></br></br></br>A wifi connection.</br></br><br></br></br></br>Everything you need.</br></br><br></br></br></br>Eternal cloud storage.</br></br><br></br></br></br>Everything you dreamt about.</br></br><br></br></br></br>A life without that sick mortal body of yours.</br></br><br></br></br></br>Feel it entering your Being...</br></br><br></br></br></br>with each breath...</br></br><br></br></br></br>with each scroll...</br></br><br></br></br></br>",7:"↓</br></br><br></br></br></br></br></br><br></br></br></br>↓</br></br><br></br></br></br></br></br><br></br></br></br>↓</br></br><br><br></br></br></br></br></br><br></br></br></br>↓</br></br><br><br></br></br></br></br></br><br></br></br></br>Do you feel whole yet?<br></br></br></br></br></br><br></br></br></br></br></br><br>↓</br></br><br><br></br></br></br></br></br><br></br></br></br>↓</br></br><br><br></br></br></br></br></br><br></br></br></br>↓</br></br><br><br></br></br></br></br></br><br></br></br></br>",8:"</br></br><br></br></br></br></br></br><br></br></br></br><br></br></br></br></br></br><br></br>Mmmmmh</br></br><br></br></br></br></br></br><br></br></br></br></br></br><br></br></br></br></br></br><br></br></br></br></br></br><br>Just like that</br></br><br></br></br></br></br></br><br></br></br></br></br></br></br><br></br></br></br></br></br><br>Dont' stop</br></br><br></br></br></br></br></br><br></br></br></br></br></br></br><br></br></br></br>",9:"How would you rate your experience so far?<button class='rateButton'><p class='rateButtonText'>Crap</p></button><button class='rateButton'><p class='rateButtonText'>Ok</p></button><button class='rateButton'><p class='rateButtonText'>Good</p></button><button class='rateButton'><p class='rateButtonText'>Great</p></button><button class='rateButton'><p class='rateButtonText'>Awesome</p></button></br><br></br></br></br></br><br></br></br>YOUR FEEDBACK IS IMPORTANT TO US</br><br></br></br></br></br><br></br></br>",10:"</br></br><br></br></br></br></br></br><br></br></br></br><br></br></br></br></br></br><br></br>",11:"You are not simply using a phone. You are working—providing data, generating engagement, feeding the system. Every scroll, click, and reaction fuels an economy that extracts your attention and sells it.</br><br></br></br>Doomscrolling is not a personal flaw. It is a symptom of a system that commodifies your fears and anxieties. Your despair is profitable. The real question is not whether you can stop scrolling, but whether you can dismantle the system that keeps you scrolling.</br><br></br></br>Doomscrolling is a collective experience. It is not just you scrolling through your feed. It is a shared ritual, a commmunal sacrifice of time and attention.",12:"</br></br><br></br></br></br></br></br><br></br></br></br></br></br><br></br></br></br></br></br><br></br></br></br></br></br><br></br></br></br></br></br><br></br></br></br>",13:"The endgame of doomscrolling is not a resolution but a transformation. You emerge from the cycle changed, your perception altered, your attention fragmented. The system has reshaped you into a compliant user, ready to scroll again.",14:"</br></br><br></br></br></br></br></br><br></br></br></br></br></br><br></br></br></br></br></br><br></br></br></br></br></br><br></br></br></br></br></br><br></br></br></br>"},Ue={0:"rgb(12, 12, 12)",1:"rgb(12, 12, 12)",2:"rgb(12, 12, 12)",3:"rgb(12, 12, 12)",4:"rgb(255, 255, 255)",5:"rgb(12, 12, 12)",6:"rgb(12, 12, 12)",7:"rgb(255, 255, 255)",8:"rgb(12, 12, 12)",9:"rgb(12, 12, 12)",10:"rgb(12, 12, 12)",11:"rgb(12, 12, 12)",12:"rgb(12, 12, 12)",13:"rgb(12, 12, 12)",14:"rgb(12, 12, 12)"},z={0:"#f6f6f6",1:"rgb(255, 255, 255)",2:"rgb(176, 176, 176)",3:"rgb(200, 200, 200)",4:"rgb(12, 12, 12)",5:"rgb(162, 162, 162)",6:"rgb(255, 255, 255)",7:"rgb(12, 12, 12)",8:"rgb(255, 230, 218)",9:"rgb(190, 190, 190)",10:"rgb(221, 221, 221)",11:"rgb(176, 176, 176)",12:"rgb(221, 221, 221)",13:"rgb(162, 162, 162)",14:"rgb(12, 12, 12)"},He=["sound/Female-Moan/Woman-Moaning-1.mp3","sound/Female-Moan/Woman-Moaning-2.mp3","sound/Female-Moan/Woman-Moaning-3.mp3","sound/Female-Moan/Woman-Moaning-4.mp3","sound/Female-Moan/Woman-Moaning-5.mp3","sound/Female-Moan/Woman-Moaning-6.mp3","sound/Female-Moan/Woman-Moaning-7.mp3","sound/Female-Moan/Woman-Moaning-8.mp3","sound/Female-Moan/Woman-Moaning-9.mp3","sound/Female-Moan/Woman-Moaning-10.mp3","sound/Female-Moan/Woman-Moaning-11.mp3","sound/Male-Moan/Man-Moaning-1.mp3","sound/Male-Moan/Man-Moaning-2.mp3","sound/Male-Moan/Man-Moaning-3.mp3"],qe="https://www.polygonpalm.com/?fbclid=PAQ0xDSwMG4T1leHRuA2FlbQIxMQABpybnVqs0CX8-00KknbBhhHKE4ZAmZlPQp9bRoWzB0zVsWHwHZtH5Pc5Y2AZt_aem_rFYvRISNzEXu_OtBYztRBA";let j=!1;const be=3;let P=[],X=[],ce=0;const We=100;let de,ue,me=.5;function Ye(e){const r=document.createTextNode("Any opinions to share?");e.appendChild(r),e.appendChild(document.createElement("br"));const t=document.createElement("input");t.type="text",t.id="essayInput",t.autocomplete="false",t.placeholder="Share it here...",t.maxLength=500,e.appendChild(t);const o=document.createElement("button");o.id="submitButton",o.type="button";const n=document.createElement("p");n.id="submitButtonText",n.textContent="Submit",o.appendChild(n),e.appendChild(o),o.addEventListener("click",ge.bind(null,t,o)),t.addEventListener("keydown",function(i){i.key==="Enter"&&(i.preventDefault(),ge(t,o))})}function ge(e,r){const t=e.value;if(!t||t==="Share it here..."||t.length<1){console.warn("Invalid or empty opinion input");return}de=t,e.style.display="none",r.style.display="none";const o=document.createElement("p");o.id="opinionResponse",o.textContent="Good for you!";const n=e.closest(".essay");n&&n.appendChild(o),console.log("User opinion captured:",de)}function Ge(e,r){ue=e,r.forEach(t=>{t.style.visibility="hidden",t.style.pointerEvents="none"}),console.log("User rated experience:",ue)}function Fe(e){const r=document.createTextNode("How would you rate your experience so far?");e.appendChild(r);const t=["Crap","Ok","Good","Great","Awesome"],o=[];t.forEach(i=>{const l=document.createElement("button");l.className="rateButton",l.type="button";const g=document.createElement("p");g.className="rateButtonText",g.textContent=i,l.appendChild(g),e.appendChild(l),o.push(l),l.addEventListener("click",()=>{Ge(i,o)})}),e.appendChild(document.createElement("br")),e.appendChild(document.createElement("br"));const n=document.createTextNode("Your experience is important to us!");e.appendChild(n)}function ze(){P.length===0&&(He.forEach((e,r)=>{const t=[];for(let o=0;o<be;o++){const n=new Tone.Player(e).toDestination();n.volume.value=-10,n.load(),t.push(n)}P.push(t),X.push(0)}),console.log("Moaning sound player pools initialized:",P.length,"pools with",be,"players each"))}function je(){j||(ze(),j=!0,console.log("Touch sounds enabled"))}function _e(){j=!1,console.log("Touch sounds disabled")}let W=!1,D=null,N=null,pe="rgb(240, 201, 182)",T=null,S=null;function Ve(){W||(T=document.querySelector('[data-level="8"]'),S=T?T.querySelector(".levelTitle"):null,T&&(D=window.getComputedStyle(T).backgroundColor,S&&(N=window.getComputedStyle(S).backgroundColor),W=!0,console.log("Background color change enabled for level 8 (block and title)")))}function Qe(){W&&T&&D&&(T.style.backgroundColor=D,S&&N&&(S.style.backgroundColor=N)),W=!1,T=null,S=null,D=null,N=null,console.log("Background color change disabled")}function Ke(){W&&T&&(T.style.backgroundColor=pe,S&&(S.style.backgroundColor=pe))}function Ze(){W&&T&&D&&(T.style.backgroundColor=D,S&&N&&(S.style.backgroundColor=N))}function $e(){if(!j||P.length===0)return;const e=Date.now();if(e-ce<We)return;const r=Math.floor(Math.random()*P.length),t=P[r],o=X[r],n=t[o];X[r]=(o+1)%t.length,n.loaded&&(n.start(),ce=e)}console.log("USING THISFILE");let C=0,J=0,ee=1.5;const Xe=2,Je=80,ne=document.getElementById("content-container");let d=0;window.addEventListener("DOMContentLoaded",()=>{Q(d)});function _(){ne.style.transform=`translateY(-${C}px)`,console.log("After scroll: .content-blocks =",document.querySelectorAll(".content-block").length,".virtual-blocks =",document.querySelectorAll(".virtual-block").length)}window.addEventListener("touchstart",function(e){e.touches.length===1&&(J=e.touches[0].clientY,$e(),Ke())},{passive:!0});window.addEventListener("touchend",function(e){Ze()},{passive:!0});window.addEventListener("touchmove",function(e){if(e.touches.length===1){const r=e.touches[0].clientY,t=J-r;t>0&&(C+=t*ee,_()),J=r}},{passive:!0});window.addEventListener("wheel",function(e){e.deltaY>0&&(C+=e.deltaY*Xe,_()),e.preventDefault()},{passive:!1});window.addEventListener("keydown",function(e){const r=document.activeElement;r&&(r.tagName==="INPUT"||r.tagName==="TEXTAREA")||(["ArrowDown","PageDown"," "].includes(e.key)&&(C+=Je,_(),e.preventDefault()),["ArrowUp","PageUp","Home"].includes(e.key)&&e.preventDefault())});window.addEventListener("resize",_);ne.style.willChange="transform";ne.style.transition="none";"scrollRestoration"in history&&(history.scrollRestoration="manual");const A=14;let O=!1,U=[],$=!1;function et(){console.log("Scrolling disabled - maxLevel reached!");const e=r=>(r.preventDefault(),r.stopPropagation(),!1);window.addEventListener("wheel",e,{passive:!1}),window.addEventListener("touchmove",e,{passive:!1}),window.addEventListener("scroll",e,{passive:!1}),window.addEventListener("keydown",r=>{if([32,33,34,35,36,37,38,39,40].includes(r.keyCode))return r.preventDefault(),!1}),document.body.style.overflow="hidden",tt()}function tt(){const e=document.createElement("div");e.id="completion-overlay",e.style.cssText=`
    position: fixed;
    top: 0vh;
    left: 0;
    width: 100vw;
    height: 100svh;
    z-index: 10001;
    color: rgb(246, 246, 246);
    background-color: rgb(12, 12, 12);
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 1svh;
    opacity: 0;
    transition: opacity 0.5s ease-in-out;
  `;const r=document.createElement("p");r.style.cssText=`
    text-align: center;
    display: block;
    margin: 0;
    padding-bottom: 0;
    font-size: 300%;
    font-weight: bold;
  `,r.innerHTML="CONGRATULATIONS";const t=document.createElement("p");t.style.cssText=`
    text-align: center;
    display: block;
    margin: 0;
    padding: 0;
    font-size: 150%;
    line-height: 5svh;
  `,t.innerHTML="You've scrolled to the end of the internet!<br>";const o=document.createElement("p");o.style.cssText=`
    text-align: center;
    display: block;
    margin: 0;
    padding: 0;
    font-size: 100%;
    opacity: 0.8;
    margin-top: 2svh;
  `,o.innerHTML="Now put your phone away and go outside!",e.appendChild(r),e.appendChild(t),e.appendChild(o),document.body.appendChild(e),setTimeout(()=>{e.style.opacity="1"},100)}async function rt(){if(!($||U.length===0)){for($=!0;U.length>0;){const e=U.shift();document.querySelector(`[data-level="${e}"]`)?console.log("Queue: Level",e,"already exists, skipping"):(console.log("Queue: Loading level",e),await Q(e))}$=!1}}function te(e){!document.querySelector(`[data-level="${e}"]`)&&!U.includes(e)&&(console.log("Queueing level",e),U.push(e),U.sort((t,o)=>t-o),rt())}const H=document.querySelector(".timerText"),ot=document.querySelector(".deathPage"),q=document.querySelector(".startOverButton"),M=document.querySelector(".backToPolygonPalmButton"),nt=document.querySelector(".deathMessage"),Te=document.querySelector(".deathScore");document.querySelector(".infoDiv");const fe=document.querySelector(".introPage"),Se=document.querySelector(".startButton"),it=document.querySelector(".introImg"),st=document.querySelector(".introText");setTimeout(()=>{it.style.display="block",Se.style.display="flex",st.style.display="block"},1e3);let he=!1,ye="playing",y=60;const Y=new Tone.MembraneSynth;let R=null;Y.connect(Tone.Destination);Y.volume.value=-20;const lt=3,re={},oe={};for(let e=0;e<v.length;e++){const r=v[e].name,t=v[e].soundClips[0];re[r]=[],oe[r]=0;for(let o=0;o<lt;o++){const n=new Tone.Player(t).toDestination();n.load(),re[r].push(n)}}async function at(){if(await Tone.start(),window.tombAmbiencePlayer)console.log("Ambience already started"),window.tombAmbiencePlayer.start(),window.tombAmbienceGain&&window.tombAmbienceGain.gain.linearRampTo(me,2);else{console.log("Ambience not started");const e=new Tone.Gain(0).toDestination();window.tombAmbienceGain=e,window.tombAmbiencePlayer=new Tone.Player({url:"sound/tomb-ambience.wav",loop:!0,autostart:!0}).connect(e),e.gain.linearRampTo(me,2)}}async function bt(e,r=2){console.log("Crossfading ambience"),await Tone.start();const t=window.tombAmbiencePlayer,o=window.tombAmbienceGain,n=new Tone.Gain(0).toDestination(),i=new Tone.Player({url:e,loop:!0,autostart:!0}).connect(n);n.gain.linearRampTo(.13,r),o&&t&&(o.gain.linearRampTo(0,r),setTimeout(()=>{t.stop(),t.dispose(),o.dispose()},r*1e3+100)),window.tombAmbiencePlayer=i,window.tombAmbienceGain=n}Se.addEventListener("click",()=>{pt(fe),G.observe(V),setTimeout(()=>{fe.remove(),document.querySelectorAll(".content-block").length===0&&Q(0),at()},2500),ut(60)});function ct(e){y=y+e,y<0&&(y=0),H.innerHTML="Time: "+y,y<30?H.style.color="#e53935":H.style.color=""}function dt(e){e.timesClicked++}function ke(e){return Math.floor(Math.random()*e)}async function ut(e=60){let r=!1;await Tone.start(),Tone.Transport.bpm.value=e,R&&R.dispose(),R=new Tone.Loop(t=>{y<30?(Y.triggerAttackRelease("C0","16n",t),Y.triggerAttackRelease("G0","16n",t+Tone.Time("16n"))):Y.triggerAttackRelease("C2","8n",t),y--,y<0&&(y=0),H.innerHTML="Time: "+y,y<30?H.style.color="#e53935":H.style.color="",y<=0&&!r&&(r=!0,St())},"4n"),R.start(0),Tone.Transport.start()}function mt(e){Tone.Transport.bpm.value=e}function gt(){R&&R.stop(),Tone.Transport.stop()}function pt(e){he||(he=!0,e.classList.add("fadeOut"),setTimeout(()=>{e.style.opacity=0,e.classList.remove("fadeOut")},2e3))}function ft(e){let r;Array.isArray(e)&&e.length>0?(r=v.filter(o=>e.includes(o.name)),r.length===0&&(r=v)):typeof e=="string"?(r=v.filter(o=>o.name===e),r.length===0&&(r=v)):r=v;const t=ke(r.length);return r[t]}function ht(e,r,t=null,o=!1){const n=["small","medium","large"],i=document.createElement("div"),l=document.createElement("img"),g=Math.random()*90-45;l.style.transform=`rotate(${g}deg)`,l.style.opacity=1;const k=document.createElement("img");k.loading="lazy",i.appendChild(l),i.appendChild(k);let E=t?[t]:we[e]||null,a=ft(E),c=a.image[0];const b=a.timeImage;l.setAttribute("src",c),i.setAttribute("class","distractionWrapper"),l.setAttribute("class","distractionImage"),i.setAttribute("id",a.name),k.setAttribute("src",b),k.setAttribute("class","timeImage"),vt(i,a),r?r.appendChild(i):console.log("No container");function L(){let p=l.naturalWidth,u=l.naturalHeight;const s=400,f=300;p>s&&(u*=s/p,p=s),u>f&&(p*=f/u,u=f);let w=n[ke(n.length)];w==="small"?(p/=2,u/=2,i.style.zIndex=100):w==="large"?(p*=1.5,u*=1.5,i.style.zIndex=300):i.style.zIndex=200,i.style.width=p+"px",i.style.height=u+"px",i.style.position="absolute",r.getBoundingClientRect();const h=-p*0,I=r.clientWidth-p,ie=r.clientHeight-u,se=r.querySelector(".levelTitle");let m=null;if(se){m=se.getBoundingClientRect();const x=r.getBoundingClientRect();m={left:m.left-x.left,top:m.top-x.top,right:m.right-x.left,bottom:m.bottom-x.top,width:m.width,height:m.height}}function Ce(x,ae,Ee,Le){if(!m)return!1;const F=50,Ae=m.left-F,xe=m.top-F,Me=m.right+F,Ie=m.bottom+F;return!(x>Me||x+Ee<Ae||ae>Ie||ae+Le<xe)}let K,B,Z=0;const le=50;do K=Math.floor(Math.random()*(I-h+1))+h,B=Math.max(0,Math.floor(Math.random()*(ie+1))),Z++;while(Ce(K,B,p,u)&&Z<le);Z>=le&&m&&(B=Math.max(m.bottom+100,r.clientHeight*.5),B=Math.min(B,ie)),i.style.left=K+"px",i.style.top=B+"px"}l.onload=function(){L(),l.onload=void 0},l.complete&&(L(),l.onload=void 0)}function yt(e){const r=re[e];if(!r||r.length===0)return;const t=oe[e],o=r[t];oe[e]=(t+1)%r.length;const n=[.7,1,1.5],i=n[Math.floor(Math.random()*n.length)];o.playbackRate=i,o.start()}function vt(e,r){e.addEventListener("touchstart",()=>{yt(r.name),e.style.pointerEvents="none",wt(e);const t=e.querySelector(".distractionImage");let o=t.style.width,n=t.style.height;t.src=r.image[1],t.style.width=o,t.style.height=n;const i=e.querySelector(".timeImage");i.style.visibility="visible",setTimeout(()=>{setTimeout(()=>{e.remove()},500)},500)})}document.querySelector(".pointsAndTimeBackground");function wt(e){let r=e.id;for(let t=0;t<v.length;t++)if(v[t].name==r){let o=v[t];ct(o.timeAdjustment),dt(o)}}function Tt(){document.querySelectorAll(".distractionWrapper").forEach(r=>r.remove())}const ve=["bananas","a blast","wild","juicy","well wasted time"];function St(){if(gt(),ye==="dead")return;Tt(),ye="dead";let r="This scroll was "+ve[Math.floor(Math.random()*ve.length)]+"!</br>";const t=Be();let o=t.BOOBS+t.DICK,n="",i="",l="",g="",k=" Your phone was infected by ",E="",a="",c="",b="",L="",p=" You ordered ",u="";t.NEWS==1?n=t.NEWS+" news story passed your feed and you fought ":n=t.NEWS+" news stories passed your feed and you fought ",t.TROLL==1?i=t.TROLL+" troll in the comment sections. ":i=t.TROLL+" trolls in the comment sections. ",t.BOMB==1?l=t.BOMB+" war was started as you found comfort in ":l=t.BOMB+" wars were started as you found comfort in ",t.CAT==1?c=t.CAT+" cute kitten. ":c=t.CAT+" cute kittens. ",t.DISCOUNT==1?g=t.DISCOUNT+" discount took you shopping. ":g=t.DISCOUNT+" discounts took you shopping. ",t.DRUGS==1,u=t.DRUGS+" grams of substances to keep you going. ",t.VIRUS==1?E=t.VIRUS+" virus on shady websites. ":E=t.VIRUS+" viruses on shady websites. ",o==1?a=o+" thirst trap caught you along the way":a=o+" thirst traps caught you along the way",t.MINDFULNESS==1?(b=" but you compensated with ",L=t.MINDFULNESS+" spiritual exercise to keep your soul clean. "):t.MINDFULNESS==0?(b=" and you ignored any spiritual exercises trying to keep your soul clean. ",L=""):(b=" but you compensated with ",L=t.MINDFULNESS+" spiritual exercises to keep your soul clean. "),Te.innerHTML=r+n+i+l+c+g+p+u+k+E+a+b+L,document.body.setAttribute("style","-ms-touch-action: none;"),document.body.setAttribute("style","touch-action: none;"),q.disabled=!0,M.disabled=!0,ot.style.display="flex",setTimeout(()=>{q.classList.add("fadeIn"),M.classList.add("fadeIn"),q.disabled=!1,M.disabled=!1},2e3)}q.addEventListener("click",()=>{nt.classList.add("fadeOut"),Te.classList.add("fadeOut"),q.classList.remove("fadeIn"),q.classList.add("fadeOut"),M.disabled=!0,M.classList.remove("fadeIn"),M.classList.add("fadeOut"),setTimeout(()=>{window.location.reload()},2e3)});M.addEventListener("click",()=>{window.location.href=qe});function kt(e){console.log("level: ",e),mt(Pe[e]),console.log("onLevelEntry called for level:",e),e===8?(je(),Ve()):(_e(),Qe()),document.querySelector(`[data-level="${e}"]`),e===6?(ee=.5,console.log("Level 6: Scroll speed reduced to 0.5")):(ee=1.5,console.log("Level",e+": Scroll speed set to 1.5")),e===A&&(console.log("MaxLevel reached: disabling scrolling"),setTimeout(()=>{et()},2e3))}const V=document.createElement("div");V.id="scroll-sentinel";V.style.height="1px";document.getElementById("content-container").appendChild(V);const G=new IntersectionObserver(e=>{e.forEach(r=>{if(r.isIntersecting){const t=r.target;if(t.classList.contains("level-entry-zone")){const o=parseInt(t.getAttribute("data-entry-level"),10);console.log("User entered level:",o,"currentLevel:",d),o>d&&(d=o,console.log("Updated currentLevel to:",d)),kt(o),G.unobserve(t)}else if(t.classList.contains("trigger-zone")){const o=parseInt(t.getAttribute("data-trigger-level"),10);console.log("Trigger zone intersecting for level:",o,"currentLevel:",d),o<=A&&o>d?(console.log("Preloading level:",o),te(o)):o>A&&console.log("Beyond maxLevel - no more content loading needed"),G.unobserve(t)}else if(t.id==="scroll-sentinel")if(console.log("Main sentinel intersecting, currentLevel:",d),d<A){d=d+1,console.log("Advancing to level:",d),bt(Oe[d]);const n=document.querySelectorAll(".content-block");let i=!1;n.forEach(l=>{parseInt(l.getAttribute("data-level"),10)===d&&(i=!0)}),i||te(d)}else console.log("Reached maxLevel - no more content loading needed")}})},{root:null,rootMargin:"800px",threshold:0});async function Q(e){if(console.log("loadMoreContent called. isLoading:",O),console.log("LEVEL: ",e),O)return;O=!0;const r=document.getElementById("content-container"),t=document.getElementById("scroll-sentinel");if(console.log("loadMoreContent: container:",r,"sentinel:",t),!r||!t){console.error("loadMoreContent ERROR: container or sentinel not found"),O=!1;return}let o=!1;try{const n=document.createElement("div");n.className="content-block",n.setAttribute("data-level",e),console.log("Created block for level",e),n.style.position="relative",n.style.width="100vw",n.style.margin="0",n.style.padding="0",n.style.background=z[e]||"red",n.style.opacity="0",n.style.transition="opacity 0.3s ease-in-out",n.offsetHeight,e===A&&(console.log("Final level (maxLevel) block created for level",e),document.body.style.backgroundColor=z[e],console.log("Set body background to level",e,"color:",z[e]));const i=document.createElement("div");i.className="levelTitle",i.innerHTML=De[e]||"",i.style.backgroundColor=z[e],n.appendChild(i);const l=document.createElement("p");l.className="essay",l.style.color=Ue[e],e===3?Ye(l):e===9?Fe(l):l.innerHTML=Ne[e]||"",n.appendChild(l);const g=we[e]||[],k=Re[e]||[];let E=[];for(let s=0;s<g.length;s++){const f=g[s],w=k[s]||0;let h=v.find(I=>I.name===f);if(h&&h.image&&h.image[0])for(let I=0;I<w;I++)E.push(h.image[0])}try{await Promise.all(E.map(s=>new Promise(f=>{const w=new window.Image;w.onload=f,w.onerror=f,w.src=s})))}catch(s){console.error("Error preloading images:",s),o=!0}let a=[];for(let s=0;s<g.length;s++){const f=g[s],w=k[s]||0;for(let h=0;h<w;h++)a.push({level:e,block:n,type:f,instant:h<4})}for(let s=a.length-1;s>0;s--){const f=Math.floor(Math.random()*(s+1));[a[s],a[f]]=[a[f],a[s]]}for(let s=0;s<a.length;s++)setTimeout(()=>{ht(a[s].level,a[s].block,a[s].type,a[s].instant)},s*200);const c=document.createElement("div");c.className="level-entry-zone",c.setAttribute("data-entry-level",e),c.style.position="absolute",c.style.top="10vh",c.style.width="100%",c.style.height="1px",c.style.pointerEvents="none",c.style.opacity="0",n.appendChild(c),G.observe(c);const b=document.createElement("div");b.className="trigger-zone",b.setAttribute("data-trigger-level",e+1),b.style.position="absolute",b.style.bottom="150vh",b.style.width="100%",b.style.height="1px",b.style.pointerEvents="none",b.style.opacity="0",n.appendChild(b),e+1<=A?(G.observe(b),console.log("Created trigger zone for level",e+1)):console.log("No trigger zone needed - beyond maxLevel"),r.insertBefore(n,t),setTimeout(()=>{n.style.opacity="1"},50),console.log("Inserted new content-block. Total .content-blocks:",document.querySelectorAll(".content-block").length),console.log("Sentinel rect after insertion:",t.getBoundingClientRect()),r.querySelectorAll(".content-block").forEach(s=>{if(parseInt(s.getAttribute("data-level"),10)<d-3){const w=s.offsetTop,h=s.offsetHeight;C>=w+h&&(C-=h,C<0&&(C=0),r.style.transform=`translateY(-${C}px)`),s.remove()}});const p=document.querySelectorAll(".content-block");console.log("All .content-block data-levels:",Array.from(p).map(s=>s.getAttribute("data-level")));const u=t.getBoundingClientRect();e<A&&u.top<window.innerHeight+600&&setTimeout(()=>{Q(e+2)},0)}finally{O=!1}}window.addEventListener("scroll",()=>{if(O)return;const e=document.getElementById("scroll-sentinel");if(!e)return;if(e.getBoundingClientRect().top<window.innerHeight+600){const t=document.querySelectorAll(".content-block");let o=-1;t.forEach(n=>{const i=parseInt(n.getAttribute("data-level"),10);i>o&&(o=i)}),o<A&&te(o+1)}});
